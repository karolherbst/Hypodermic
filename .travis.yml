language: cpp
compiler:
  - gcc
  - clang
env:
  - BT=SHARED
  - BT=STATIC
matrix:
  include:
    - compiler: gcc
      env: BT=SHARED CFLAGS=--coverage CXXFLAGS=--coverage COVERAGE=1
      fast_finish: true
before_install:
  - sudo apt-get update
  - sudo apt-get install libboost-dev libboost-signals-dev libboost-system-dev libboost-test-dev
  - if [ -n "$COVERAGE" ]; then sudo pip install cpp-coveralls --use-mirrors; fi
script:
  - cmake . -DHYPODERMIC_BUILD_TYPE=$BT
  - make -j4
after_success:
  - if [ -n "$COVERAGE" ]; then coveralls --exclude CMakeFiles --exclude-pattern 'CMake[^\.]*\.c(?:pp)?' --exclude-pattern '[^\.]*\.h' > /dev/null; fi
